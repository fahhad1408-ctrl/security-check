<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙØ­Øµ Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ø°ÙƒÙŠ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --primary: #00d1ff; --bg: #050505; --card: #111; --danger: #ff4d4d; --safe: #00ff88; }
        body { background: var(--bg); color: #fff; font-family: sans-serif; margin: 0; padding: 15px; text-align: center; }
        .report { background: var(--card); border-radius: 15px; padding: 20px; text-align: right; border: 1px solid #222; margin-top: 20px; }
        .item { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #222; font-size: 14px; }
        .val { color: var(--primary); font-weight: bold; }
        .verdict { margin-top: 20px; padding: 15px; border-radius: 12px; font-weight: bold; border: 1px solid #333; }
        .v-safe { border-color: var(--safe); color: var(--safe); }
        .v-danger { border-color: var(--danger); color: var(--danger); }
        .loading-dots:after { content: ' .'; animation: dots 1s steps(5, end) infinite; }
        @keyframes dots { 0%, 20% { color: rgba(0,0,0,0); text-shadow: .5em 0 0 rgba(0,0,0,0), 1em 0 0 rgba(0,0,0,0); } 40% { color: white; text-shadow: .5em 0 0 rgba(0,0,0,0), 1em 0 0 rgba(0,0,0,0); } 60% { text-shadow: .5em 0 0 white, 1em 0 0 rgba(0,0,0,0); } 80%, 100% { text-shadow: .5em 0 0 white, 1em 0 0 white; } }
    </style>
</head>
<body>

    <h2 id="title">ØªÙ‚Ø±ÙŠØ± Ø£Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²</h2>
    
    <div id="report" class="report">
        <div class="item"><span>Ø§Ù„Ø¯ÙˆÙ„Ø©:</span><span id="country" class="val">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¬Ù„Ø¨</span></div>
        <div class="item"><span>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</span><span id="city" class="val">..</span></div>
        <div class="item"><span>Ø§Ù„Ø­ÙŠ:</span><span id="neighborhood" class="val">..</span></div>
        <div class="item"><span>Ù…Ø²ÙˆØ¯ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª:</span><span id="isp" class="val">..</span></div>
        <div class="item"><span>Ø­Ø§Ù„Ø© Ø§Ù„Ù€ VPN:</span><span id="vpn-stat" class="val">ÙŠÙØ­Øµ..</span></div>
        
        <div id="verdict" class="verdict">Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
        <button onclick="location.reload()" style="width:100%; padding:12px; margin-top:15px; background:#222; color:#fff; border:1px solid #444; border-radius:10px;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙØ­Øµ</button>
    </div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    async function startAudit() {
        let vpnDetected = false;
        
        // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù€ IP Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø®Ø·Ø£ Ø¨Ù‡Ø¯ÙˆØ¡
        try {
            const ipRes = await fetch('https://ipinfo.io/json?token=7ba0a7c473729e').catch(() => null); 
            if (ipRes) {
                const data = await ipRes.json();
                document.getElementById('country').innerText = data.country;
                document.getElementById('city').innerText = data.city;
                document.getElementById('isp').innerText = data.org.split(' ').slice(1).join(' ');
                
                // ÙØ­Øµ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©
                const localTZ = Intl.DateTimeFormat().resolvedOptions().timeZone;
                if (!localTZ.includes(data.timezone.split('/')[1])) vpnDetected = true;
            }
        } catch(e) {}

        // Ø¬Ù„Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ
        navigator.geolocation.getCurrentPosition(async (pos) => {
            document.getElementById('vpn-stat').innerText = vpnDetected ? "Ù†Ø´Ø· ğŸš©" : "ØºÙŠØ± Ù†Ø´Ø· âœ…";
            
            // Ø¬Ù„Ø¨ Ø§Ù„Ø­ÙŠ
            try {
                const geo = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${pos.coords.latitude}&lon=${pos.coords.longitude}&accept-language=ar`);
                const geoData = await geo.json();
                document.getElementById('neighborhood').innerText = geoData.address.suburb || geoData.address.neighbourhood || "Ù…ØªØµÙ„";
            } catch(e) { document.getElementById('neighborhood').innerText = "ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯"; }

            const v = document.getElementById('verdict');
            if (vpnDetected) {
                v.innerText = "ØªØ­Ø°ÙŠØ±: ØªÙ… Ø±ØµØ¯ ØªØºÙŠÙŠØ± ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ© âš ï¸";
                v.className = "verdict v-danger";
            } else {
                v.innerText = "Ø¬Ù‡Ø§Ø²Ùƒ Ø³Ù„ÙŠÙ… ÙˆØ¢Ù…Ù† âœ…";
                v.className = "verdict v-safe";
            }
        }, () => {
            document.getElementById('verdict').innerText = "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙˆÙ‚Ø¹";
        }, { enableHighAccuracy: true });
    }

    startAudit();
</script>
</body>
</html>
